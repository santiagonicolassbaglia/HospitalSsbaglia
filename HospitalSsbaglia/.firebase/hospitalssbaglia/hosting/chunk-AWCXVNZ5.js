import{a as J}from"./chunk-Q7FLMN77.js";import{e as H}from"./chunk-OIK5GHFL.js";import{a as Y}from"./chunk-MFCKY6MA.js";import{s as B,t as R}from"./chunk-WQDWLB3F.js";import{d as A}from"./chunk-Q3TEWXKA.js";import{h as N,i as z,k as U}from"./chunk-TQDNXVMP.js";import{$a as v,Da as O,Ga as s,Ha as h,Ua as u,Wa as d,Xa as S,Ya as r,Za as c,_a as I,cb as x,db as l,fa as k,fb as p,gb as y,ib as j,nb as F,pa as f,pb as V,qa as _,rb as $}from"./chunk-75HCPL27.js";import{j as D}from"./chunk-GLKGYJID.js";var b=class{constructor(a,i,e,t,o,g,C,T="pendiente",E,M,w,m,P,q){this.id=a,this.pacienteId=i,this.pacienteNombre=e,this.especialidad=t,this.especialistaId=o,this.especialistaNombre=g,this.fechaHora=C,this.estado=T,this.comentario=E,this.dniUsuario=M,this.mostrarresenia=w,this.mostrarcomentario=m,this.historiaClinica=P,this.calificacion=q}};function G(n,a){if(n&1){let i=v();r(0,"div",7),x("click",function(){let t=f(i).$implicit,o=l();return _(o.seleccionarEspecialidad(t))}),r(1,"button"),I(2,"img",8),r(3,"span"),p(4),c()()()}if(n&2){let i=a.$implicit,e=l();s(),S("selected",i===e.especialidadSeleccionada),s(),d("src",e.getEspecialidadImagen(i),O),s(2),y(i)}}function K(n,a){if(n&1){let i=v();r(0,"div",7),x("click",function(){let t=f(i).$implicit,o=l(2);return _(o.seleccionarEspecialista(t))}),r(1,"button"),I(2,"img",10),r(3,"span"),p(4),c()()()}if(n&2){let i=a.$implicit,e=l(2);s(),S("selected",i===e.especialistaSeleccionado),s(),d("src",i.imagenes[0],O),s(2),j("",i.nombre," ",i.apellido,"")}}function L(n,a){if(n&1&&(r(0,"div",9)(1,"h2"),p(2,"Especialistas"),c(),r(3,"div",2),u(4,K,5,5,"div",3),c()()),n&2){let i=l();s(4),d("ngForOf",i.especialistas)}}function Q(n,a){if(n&1){let i=v();r(0,"div",7),x("click",function(){let t=f(i).$implicit,o=l(2);return _(o.seleccionarTurno(t))}),r(1,"button"),p(2),V(3,"date"),c()()}if(n&2){let i=a.$implicit,e=l(2);s(),S("selected",i===e.turnoSeleccionado),s(),y($(3,3,i,"dd/MM HH:mm"))}}function W(n,a){if(n&1&&(r(0,"div",11)(1,"h2"),p(2,"Turnos Disponibles"),c(),r(3,"div",2),u(4,Q,4,6,"div",3),c()()),n&2){let i=l();s(4),d("ngForOf",i.turnosDisponibles)}}function X(n,a){n&1&&(r(0,"div",14)(1,"p"),p(2,"Turno solicitado con \xE9xito"),c()())}function Z(n,a){if(n&1){let i=v();r(0,"div",12)(1,"button",7),x("click",function(){f(i);let t=l();return _(t.confirmarTurno())}),p(2,"Confirmar Turno"),c(),u(3,X,3,0,"div",13),c()}if(n&2){let i=l();s(3),d("ngIf",i.mensajeConfirmacion)}}var pe=(()=>{let a=class a{constructor(e,t,o,g){this.authService=e,this.turnoService=t,this.especialistaService=o,this.router=g,this.especialidades=[],this.especialistas=[],this.turnosDisponibles=[],this.especialidadSeleccionada=null,this.especialistaSeleccionado=null,this.turnoSeleccionado=null,this.dniUsuario="",this.mensajeConfirmacion=!1}ngOnInit(){this.cargarEspecialidades()}cargarEspecialidades(){this.authService.obtenerEspecialidades().subscribe(e=>{this.especialidades=e})}seleccionarEspecialidad(e){this.especialidadSeleccionada=e,this.cargarEspecialistasPorEspecialidad(e),this.mensajeConfirmacion=!1}cargarEspecialistasPorEspecialidad(e){this.authService.getUsuariosByEspecialidad(e).subscribe(t=>{this.especialistas=t})}seleccionarEspecialista(e){this.especialistaSeleccionado=e,this.cargarTurnosDisponibles(e),this.mensajeConfirmacion=!1}cargarTurnosDisponibles(e){this.especialistaService.getDisponibilidad(e.uid).subscribe(t=>{this.turnosDisponibles=this.generarTurnosDisponibles(t)})}generarTurnosDisponibles(e){let t=[],o=new Date;return e.forEach(g=>{g.horarios.forEach(C=>{let[T,E]=C.inicio.split(":").map(Number),[M,w]=C.fin.split(":").map(Number),m=new Date(o.getFullYear(),o.getMonth(),o.getDate(),T,E),P=new Date(o.getFullYear(),o.getMonth(),o.getDate(),M,w);for(;m<P;)t.push(new Date(m)),m.setMinutes(m.getMinutes()+30)})}),t}seleccionarTurno(e){this.turnoSeleccionado=e,this.mensajeConfirmacion=!1}confirmarTurno(){return D(this,null,function*(){try{let e=yield this.authService.usuarioActual(),t=new b("",e.uid,`${e.nombre} ${e.apellido}`,this.especialidadSeleccionada,this.especialistaSeleccionado.uid,`${this.especialistaSeleccionado.nombre} ${this.especialistaSeleccionado.apellido}`,this.turnoSeleccionado,"pendiente","",e.dni||"",!1,!1);t.historiaClinica===void 0&&delete t.historiaClinica,yield this.turnoService.crearTurno(t),console.log("Turno creado con \xE9xito"),this.mensajeConfirmacion=!0,setTimeout(()=>{this.router.navigate(["/home"])},2e3)}catch(e){console.error("Error al crear el turno:",e)}})}getEspecialidadImagen(e){switch(e){case"Cardiolog\xEDa":return"assets/imagenes/especialidades/cardiologo.png";case"Dermatolog\xEDa":return"assets/imagenes/especialidades/dermatologo.jpg";case"Neurolog\xEDa":return"assets/imagenes/especialidades/neurologo.png";case"Pediatr\xEDa":return"assets/imagenes/especialidades/pediatra.png";default:return"assets/imagenes/especialidades/default.png"}}};a.\u0275fac=function(t){return new(t||a)(h(A),h(Y),h(J),h(H))},a.\u0275cmp=k({type:a,selectors:[["app-solicitar-turno"]],standalone:!0,features:[F],decls:9,vars:4,consts:[[1,"contenedor"],[1,"especialidades"],[1,"botones"],[3,"click",4,"ngFor","ngForOf"],["class","especialistas",4,"ngIf"],["class","turnos",4,"ngIf"],["class","confirmar",4,"ngIf"],[3,"click"],["alt","Especialidad",3,"src"],[1,"especialistas"],["alt","Especialista",3,"src"],[1,"turnos"],[1,"confirmar"],["class","mensaje",4,"ngIf"],[1,"mensaje"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"h2"),p(3,"Especialidades"),c(),r(4,"div",2),u(5,G,5,4,"div",3),c()(),u(6,L,5,1,"div",4)(7,W,5,1,"div",5)(8,Z,4,1,"div",6),c()),t&2&&(s(5),d("ngForOf",o.especialidades),s(),d("ngIf",o.especialidadSeleccionada),s(),d("ngIf",o.especialistaSeleccionado),s(),d("ngIf",o.turnoSeleccionado))},dependencies:[N,z,B,R,U],styles:[".contenedor[_ngcontent-%COMP%]{margin:20px}h2[_ngcontent-%COMP%]{margin-bottom:20px;font-family:Arial,sans-serif;color:#333;text-align:center}.botones[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px}button[_ngcontent-%COMP%]{background-color:#007bff;border:none;color:#fff;padding:10px;text-align:center;text-decoration:none;display:flex;flex-direction:column;align-items:center;font-size:16px;cursor:pointer;border-radius:5px;transition:background-color .3s,transform .3s;min-width:120px;min-height:150px}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:214px;height:230px;margin-bottom:10px}button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:5px;font-size:14px}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.05)}button.selected[_ngcontent-%COMP%]{background-color:#28a745;transform:scale(1.1)}button[_ngcontent-%COMP%]:focus{outline:none}.confirmar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#28a745;width:100%;padding:15px;font-size:18px;margin-top:20px}.confirmar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#218838}.mensaje[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding:20px;background-color:#002beb;border-radius:5px}.mensaje[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#fff;font-weight:700}"]});let n=a;return n})();export{pe as a};
