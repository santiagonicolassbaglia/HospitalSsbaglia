import{a as q}from"./chunk-Q7FLMN77.js";import{e as A}from"./chunk-OIK5GHFL.js";import{a as J}from"./chunk-MFCKY6MA.js";import{s as R,t as Y}from"./chunk-WQDWLB3F.js";import{d as B}from"./chunk-Q3TEWXKA.js";import{h as z,i as U,k as H}from"./chunk-TQDNXVMP.js";import{$a as h,Da as I,Ga as r,Ha as S,Ua as m,Wa as d,Xa as b,Ya as s,Za as c,_a as y,cb as v,db as l,fa as j,fb as p,gb as T,ib as V,nb as F,pa as g,pb as $,qa as f,rb as N}from"./chunk-75HCPL27.js";import{j as k}from"./chunk-GLKGYJID.js";var E=class{constructor(a,i,e,t,o,u,x,C="pendiente",w,M,D,P,_,O){this.id=a,this.pacienteId=i,this.pacienteNombre=e,this.especialidad=t,this.especialistaId=o,this.especialistaNombre=u,this.fechaHora=x,this.estado=C,this.comentario=w,this.dniUsuario=M,this.mostrarresenia=D,this.mostrarcomentario=P,this.historiaClinica=_,this.calificacion=O}};function G(n,a){if(n&1){let i=h();s(0,"div",8),v("click",function(){let t=g(i).$implicit,o=l();return f(o.seleccionarEspecialidad(t))}),s(1,"button"),y(2,"img",9),s(3,"span"),p(4),c()()()}if(n&2){let i=a.$implicit,e=l();r(),b("selected",i===e.especialidadSeleccionada),r(),d("src",e.getEspecialidadImagen(i),I),r(2),T(i)}}function K(n,a){if(n&1){let i=h();s(0,"div",8),v("click",function(){let t=g(i).$implicit,o=l(2);return f(o.seleccionarEspecialista(t))}),s(1,"button"),y(2,"img",11),s(3,"span"),p(4),c()()()}if(n&2){let i=a.$implicit,e=l(2);r(),b("selected",i===e.especialistaSeleccionado),r(),d("src",i.imagenes[0],I),r(2),V("",i.nombre," ",i.apellido,"")}}function L(n,a){if(n&1&&(s(0,"div",10)(1,"h2"),p(2,"Especialistas"),c(),s(3,"div",2),m(4,K,5,5,"div",3),c()()),n&2){let i=l();r(4),d("ngForOf",i.especialistas)}}function Q(n,a){if(n&1){let i=h();s(0,"div",8),v("click",function(){let t=g(i).$implicit,o=l(2);return f(o.seleccionarDia(t))}),s(1,"button"),p(2),c()()}if(n&2){let i=a.$implicit,e=l(2);r(),b("selected",i===e.diaSeleccionado)("disponible",e.tieneTurnos(i)),r(),T(i)}}function W(n,a){if(n&1&&(s(0,"div",12)(1,"h2"),p(2,"D\xEDas Disponibles"),c(),s(3,"div",2),m(4,Q,3,5,"div",3),c()()),n&2){let i=l();r(4),d("ngForOf",i.diasDisponibles)}}function X(n,a){if(n&1){let i=h();s(0,"div",8),v("click",function(){let t=g(i).$implicit,o=l(2);return f(o.seleccionarTurno(t))}),s(1,"button"),p(2),$(3,"date"),c()()}if(n&2){let i=a.$implicit,e=l(2);r(),b("selected",i===e.turnoSeleccionado),r(),T(N(3,3,i,"dd/MM HH:mm"))}}function Z(n,a){if(n&1&&(s(0,"div",13)(1,"h2"),p(2,"Turnos Disponibles"),c(),s(3,"div",2),m(4,X,4,6,"div",3),c()()),n&2){let i=l();r(4),d("ngForOf",i.turnosDisponibles[i.diaSeleccionado])}}function ee(n,a){n&1&&(s(0,"div",16)(1,"p"),p(2,"Turno solicitado con \xE9xito"),c()())}function ie(n,a){if(n&1){let i=h();s(0,"div",14)(1,"button",8),v("click",function(){g(i);let t=l();return f(t.confirmarTurno())}),p(2,"Confirmar Turno"),c(),m(3,ee,3,0,"div",15),c()}if(n&2){let i=l();r(3),d("ngIf",i.mensajeConfirmacion)}}var ue=(()=>{let a=class a{constructor(e,t,o,u){this.authService=e,this.turnoService=t,this.especialistaService=o,this.router=u,this.especialidades=[],this.especialistas=[],this.turnosDisponibles={},this.diasDisponibles=[],this.especialidadSeleccionada=null,this.especialistaSeleccionado=null,this.diaSeleccionado=null,this.turnoSeleccionado=null,this.dniUsuario="",this.mensajeConfirmacion=!1}ngOnInit(){this.cargarEspecialidades()}cargarEspecialidades(){this.authService.obtenerEspecialidades().subscribe(e=>{this.especialidades=e})}seleccionarEspecialidad(e){this.especialidadSeleccionada=e,this.cargarEspecialistasPorEspecialidad(e),this.mensajeConfirmacion=!1}cargarEspecialistasPorEspecialidad(e){this.authService.getUsuariosByEspecialidad(e).subscribe(t=>{this.especialistas=t})}seleccionarEspecialista(e){this.especialistaSeleccionado=e,this.cargarTurnosDisponibles(e),this.mensajeConfirmacion=!1}cargarTurnosDisponibles(e){this.especialistaService.getDisponibilidad(e.uid).subscribe(t=>{this.turnosDisponibles=this.generarTurnosDisponibles(t),this.diasDisponibles=Object.keys(this.turnosDisponibles)})}generarTurnosDisponibles(e){let t={},o=new Date;return e.forEach(u=>{let x=u.dia;t[x]||(t[x]=[]),u.horarios.forEach(C=>{let[w,M]=C.inicio.split(":").map(Number),[D,P]=C.fin.split(":").map(Number),_=new Date(o.getFullYear(),o.getMonth(),o.getDate(),w,M),O=new Date(o.getFullYear(),o.getMonth(),o.getDate(),D,P);for(;_<O;)t[x].push(new Date(_)),_.setMinutes(_.getMinutes()+30)})}),t}seleccionarDia(e){this.diaSeleccionado=e,this.turnoSeleccionado=null}seleccionarTurno(e){this.turnoSeleccionado=e,this.mensajeConfirmacion=!1}confirmarTurno(){return k(this,null,function*(){try{let e=yield this.authService.usuarioActual(),t=new E("",e.uid,`${e.nombre} ${e.apellido}`,this.especialidadSeleccionada,this.especialistaSeleccionado.uid,`${this.especialistaSeleccionado.nombre} ${this.especialistaSeleccionado.apellido}`,this.turnoSeleccionado,"pendiente","",e.dni||"",!1,!1);t.historiaClinica===void 0&&delete t.historiaClinica,yield this.turnoService.crearTurno(t),console.log("Turno creado con \xE9xito"),this.mensajeConfirmacion=!0,setTimeout(()=>{this.router.navigate(["/home"])},1e3)}catch(e){console.error("Error al crear el turno:",e)}})}getEspecialidadImagen(e){switch(e){case"Cardiolog\xEDa":return"assets/imagenes/especialidades/cardiologo.png";case"Dermatolog\xEDa":return"assets/imagenes/especialidades/dermatologo.jpg";case"Neurolog\xEDa":return"assets/imagenes/especialidades/neurologo.png";case"Pediatr\xEDa":return"assets/imagenes/especialidades/pediatra.png";default:return"assets/imagenes/especialidades/default.png"}}tieneTurnos(e){return this.turnosDisponibles[e]&&this.turnosDisponibles[e].length>0}};a.\u0275fac=function(t){return new(t||a)(S(B),S(J),S(q),S(A))},a.\u0275cmp=j({type:a,selectors:[["app-solicitar-turno"]],standalone:!0,features:[F],decls:10,vars:5,consts:[[1,"contenedor"],[1,"especialidades"],[1,"botones"],[3,"click",4,"ngFor","ngForOf"],["class","especialistas",4,"ngIf"],["class","dias",4,"ngIf"],["class","turnos",4,"ngIf"],["class","confirmar",4,"ngIf"],[3,"click"],["alt","Especialidad",3,"src"],[1,"especialistas"],["alt","Especialista",3,"src"],[1,"dias"],[1,"turnos"],[1,"confirmar"],["class","mensaje",4,"ngIf"],[1,"mensaje"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"h2"),p(3,"Especialidades"),c(),s(4,"div",2),m(5,G,5,4,"div",3),c()(),m(6,L,5,1,"div",4)(7,W,5,1,"div",5)(8,Z,5,1,"div",6)(9,ie,4,1,"div",7),c()),t&2&&(r(5),d("ngForOf",o.especialidades),r(),d("ngIf",o.especialidadSeleccionada),r(),d("ngIf",o.especialistaSeleccionado),r(),d("ngIf",o.diaSeleccionado),r(),d("ngIf",o.turnoSeleccionado))},dependencies:[z,U,R,Y,H],styles:[".contenedor[_ngcontent-%COMP%]{margin:20px}h2[_ngcontent-%COMP%]{margin-bottom:20px;font-family:Arial,sans-serif;color:#333;text-align:center}.botones[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px}button[_ngcontent-%COMP%]{background-color:#007bff;border:none;color:#fff;padding:10px;text-align:center;text-decoration:none;display:flex;flex-direction:column;align-items:center;font-size:16px;cursor:pointer;border-radius:5px;transition:background-color .3s,transform .3s;min-width:120px;min-height:150px}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:214px;height:230px;margin-bottom:10px}button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:5px;font-size:14px}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.05)}button.selected[_ngcontent-%COMP%]{background-color:#28a745;transform:scale(1.1)}button[_ngcontent-%COMP%]:focus{outline:none}button.disponible[_ngcontent-%COMP%]{background-color:#28a745}.confirmar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#28a745;width:100%;padding:15px;font-size:18px;margin-top:20px}.confirmar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#218838}.mensaje[_ngcontent-%COMP%]{text-align:center;margin-top:20px;padding:20px;background-color:#002beb;border-radius:5px}.mensaje[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#fff;font-weight:700}"]});let n=a;return n})();export{ue as a};
