import{a as W}from"./chunk-MFCKY6MA.js";import{a as $}from"./chunk-CBWNEQSN.js";import{b as H,d as G,g as z,s as B}from"./chunk-WQDWLB3F.js";import{d as N}from"./chunk-Q3TEWXKA.js";import{h as k,i as D,k as V}from"./chunk-TQDNXVMP.js";import{$a as b,Ga as s,Ha as C,Ua as m,Wa as u,Ya as l,Za as r,cb as f,db as _,fa as F,fb as c,hb as d,jb as y,kb as M,lb as w,nb as I,ob as O,pa as g,pb as T,qa as h,rb as A,sb as P}from"./chunk-75HCPL27.js";import{a as E,b as S,j as v}from"./chunk-GLKGYJID.js";var j=()=>["especialidad","especialistaNombre","pacienteNombre","estado"];function Y(o,a){if(o&1){let n=b();l(0,"button",8),f("click",function(){let t=g(n).$implicit,i=_();return i.filtroEspecialidad=t,h(i.aplicarFiltro())}),c(1),r()}if(o&2){let n=a.$implicit;s(),d(" ",n," ")}}function q(o,a){if(o&1){let n=b();l(0,"button",8),f("click",function(){let t=g(n).$implicit,i=_();return i.filtroEspecialista=t.id,h(i.aplicarFiltro())}),c(1),r()}if(o&2){let n=a.$implicit;s(),d(" ",n.nombre," ")}}function L(o,a){if(o&1){let n=b();l(0,"button",8),f("click",function(){g(n);let t=_().$implicit,i=_();return h(i.cancelarTurno(t,"Raz\xF3n de cancelaci\xF3n"))}),c(1,"Cancelar Turno"),r()}}function R(o,a){if(o&1&&(l(0,"div",9)(1,"p"),c(2),r(),l(3,"p"),c(4),r(),l(5,"p"),c(6),r(),l(7,"p"),c(8),T(9,"date"),r(),l(10,"p"),c(11),r(),m(12,L,2,0,"button",10),r()),o&2){let n=a.$implicit;s(2),d("Especialidad: ",n.especialidad,""),s(2),d("Especialista: ",n.especialistaNombre,""),s(2),d("Paciente: ",n.pacienteNombre,""),s(2),d("Fecha y Hora: ",A(9,6,n.fechaHora,"short"),""),s(3),d("Estado: ",n.estado,""),s(),u("ngIf",n.estado!=="confirmado"&&n.estado!=="realizado"&&n.estado!=="cancelado")}}var te=(()=>{let a=class a{constructor(e,t){this.authService=e,this.turnoService=t,this.turnos=[],this.turnosFiltrados=[],this.especialidades=[],this.especialistas=[],this.filtroEspecialidad="",this.filtroEspecialista="",this.filtroGeneral=""}ngOnInit(){return v(this,null,function*(){this.turnoService.getTurnos().subscribe(e=>{this.turnos=e.map(t=>S(E({},t),{fechaHora:this.convertTimestampToDate(t.fechaHora)})),this.turnos.sort((t,i)=>t.fechaHora.getTime()-i.fechaHora.getTime()),this.turnosFiltrados=this.turnos,this.obtenerEspecialidadesYEspecialistas(this.turnos)})})}convertTimestampToDate(e){return e instanceof Date?e:e.toDate()}obtenerEspecialidadesYEspecialistas(e){let t=new Set,i=new Set;e.forEach(p=>{t.add(p.especialidad),i.add({id:p.especialistaId,nombre:p.especialistaNombre})}),this.especialidades=Array.from(t),this.especialistas=Array.from(i)}aplicarFiltro(){this.turnosFiltrados=this.turnos.filter(e=>(this.filtroEspecialidad===""||e.especialidad===this.filtroEspecialidad)&&(this.filtroEspecialista===""||e.especialistaId===this.filtroEspecialista))}cancelarTurno(e,t){return v(this,null,function*(){e.estado!=="confirmado"&&e.estado!=="realizado"&&e.estado!=="cancelado"&&(e.estado="cancelado",e.comentario=t,yield this.turnoService.actualizarTurno(e))})}};a.\u0275fac=function(t){return new(t||a)(C(N),C(W))},a.\u0275cmp=F({type:a,selectors:[["app-turnos-administrador"]],standalone:!0,features:[I],decls:10,vars:9,consts:[[1,"filtros"],[1,"filtro-especialidad"],[3,"click",4,"ngFor","ngForOf"],[1,"filtro-especialista"],[1,"filtro-busqueda"],["type","text","placeholder","Buscar...",3,"ngModelChange","input","ngModel"],[1,"turnos"],["class","turno",4,"ngFor","ngForOf"],[3,"click"],[1,"turno"],[3,"click",4,"ngIf"]],template:function(t,i){t&1&&(l(0,"div",0)(1,"div",1),m(2,Y,2,1,"button",2),r(),l(3,"div",3),m(4,q,2,1,"button",2),r(),l(5,"div",4)(6,"input",5),w("ngModelChange",function(x){return M(i.filtroGeneral,x)||(i.filtroGeneral=x),x}),f("input",function(){return i.aplicarFiltro()}),r()()(),l(7,"div",6),m(8,R,13,9,"div",7),T(9,"filtrarDatos"),r()),t&2&&(s(2),u("ngForOf",i.especialidades),s(2),u("ngForOf",i.especialistas),s(2),y("ngModel",i.filtroGeneral),s(2),u("ngForOf",P(9,4,i.turnosFiltrados,O(8,j),i.filtroGeneral)))},dependencies:[k,D,V,B,H,G,z,$],styles:["h2[_ngcontent-%COMP%]{color:#333;text-align:center}div[_ngcontent-%COMP%]{margin-bottom:10px}label[_ngcontent-%COMP%]{margin-right:5px}input[type=text][_ngcontent-%COMP%]{margin-right:10px;padding:5px;border:1px solid #ccc;border-radius:4px}.turno[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;margin-bottom:10px;border-radius:4px}.turno[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0}button[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;padding:10px 20px;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#d32f2f}"]});let o=a;return o})();export{te as a};
