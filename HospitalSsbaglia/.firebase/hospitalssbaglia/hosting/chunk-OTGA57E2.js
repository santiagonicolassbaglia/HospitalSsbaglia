import{a as j,b as S,c as T,d as E,e as x,f as V,g as G,h as W,j as A,k as D,o as P,p as B,q as z}from"./chunk-73WKMPDJ.js";import{a as U}from"./chunk-ZTAWAFJC.js";import{e as R,f as L,w as N}from"./chunk-F6H7HBO4.js";import{i as y}from"./chunk-QHBLLVFO.js";import{Fa as s,Ga as p,Ta as v,Va as d,Xa as n,Ya as i,Za as g,bb as h,ca as k,cb as w,db as c,eb as I,fa as u,fb as F,hb as b,ib as C,jb as _,lb as M,wa as f}from"./chunk-EA3IIICE.js";import{f as O}from"./chunk-RDYEX3OW.js";function K(r,a){r&1&&(n(0,"span",7),c(1,"\u2714\uFE0F Correcto"),i())}function X(r,a){r&1&&(n(0,"span",8),c(1,"\u274C Incorrecto"),i())}var Q=(()=>{let a=class a{constructor(e){this.fb=e,this.captchaValid=null,this.captchaResolved=new f,this.captchaForm=this.fb.group({captchaResponse:["",[T.required]]}),this.generateCaptcha()}ngOnInit(){this.captchaForm.get("captchaResponse")?.valueChanges.subscribe(e=>{this.validateCaptcha(e)})}generateCaptcha(){let e=Math.floor(Math.random()*10),o=Math.floor(Math.random()*10);this.captchaQuestion=`${e} + ${o}`,this.captchaAnswer=e+o}validateCaptcha(e){parseInt(e)===this.captchaAnswer?(this.captchaValid=!0,this.captchaResolved.emit(!0)):(this.captchaValid=!1,this.captchaResolved.emit(!1))}};a.\u0275fac=function(o){return new(o||a)(p(P))},a.\u0275cmp=u({type:a,selectors:[["app-captcha"]],outputs:{captchaResolved:"captchaResolved"},standalone:!0,features:[M],decls:8,vars:4,consts:[[1,"captcha-container",2,"background-color","rgba(10, 1, 49, 0.542)"],[1,"label-container"],[1,"captcha-container",3,"formGroup"],["for","captcha"],["type","text","id","captcha","formControlName","captchaResponse","placeholder","Captcha"],["class","valid-feedback",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"valid-feedback"],[1,"invalid-feedback"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),c(4),i(),g(5,"input",4),v(6,K,2,0,"span",5)(7,X,2,0,"span",6),i()()()),o&2&&(s(2),d("formGroup",t.captchaForm),s(2),F("",t.captchaQuestion," = ?"),s(2),d("ngIf",t.captchaValid===!0),s(),d("ngIf",t.captchaValid===!1))},dependencies:[z,S,E,x,A,D,y],styles:[".captcha-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;border:2px solid #aaa;padding:5px;border-radius:5px}.label-container[_ngcontent-%COMP%]{margin-right:10px}.label-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-weight:700}label[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:5px;display:block}input[type=text][_ngcontent-%COMP%]{width:60px;padding:5px;font-size:1rem;border:none;outline:none}.valid-feedback[_ngcontent-%COMP%], .invalid-feedback[_ngcontent-%COMP%]{font-size:1rem;margin-top:5px;display:block}.valid-feedback[_ngcontent-%COMP%]{color:#28a745}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545}input[type=text][_ngcontent-%COMP%]::placeholder{color:#aaa;font-style:italic}"]});let r=a;return r})();function Y(r,a){if(r&1&&(n(0,"div",19),c(1),i()),r&2){let q=w();s(),I(q.mensajeError)}}var fe=(()=>{let a=class a{constructor(e,o,t){this.router=e,this.authService=o,this.loadingService=t,this.mail="",this.clave="",this.mensajeError="",this.recordarme=!1,this.captchaVerified=!1,this.fb=k(P),this.nombreUsuarioEmitido=new f}ngOnInit(){this.authService.esAdmin=!1;let e=localStorage.getItem("usuarioGuardado");if(e){let o=JSON.parse(e);this.mail=o.mail,this.clave=o.clave,this.recordarme=!0}}login(){return O(this,null,function*(){if(!this.captchaVerified){this.mensajeError="Por favor, resuelve el captcha primero.";return}this.loadingService.show(),setTimeout(()=>{this.loadingService.hide()},3e3);try{yield this.authService.login(this.mail,this.clave),this.router.navigateByUrl("home")}catch(e){console.log("Error de inicio de sesi\xF3n:",e),this.mensajeError="El correo electr\xF3nico o la contrase\xF1a son incorrectos"}})}usuarioPorDefecto(){this.mail="santiii@gmail.com",this.clave="123456",this.authService.esAdmin=!0}loginWithGoogle(){return O(this,null,function*(){try{yield this.authService.loginWithGoogle(),this.router.navigateByUrl("/home")}catch(e){console.log("Error de inicio de sesi\xF3n con Google:",e)}})}onCaptchaResolved(e){this.captchaVerified=e,this.mensajeError=e?"":"Captcha incorrecto. Por favor, int\xE9ntalo de nuevo."}};a.\u0275fac=function(o){return new(o||a)(p(R),p(N),p(U))},a.\u0275cmp=u({type:a,selectors:[["app-login"]],outputs:{nombreUsuarioEmitido:"nombreUsuarioEmitido"},standalone:!0,features:[M],decls:33,vars:4,consts:[[1,"form-signin"],[3,"ngSubmit"],[1,"h3","mb-3","fw-normal"],[1,"form-floating"],["type","email","id","email","placeholder","Email","name","email",1,"form-control",3,"ngModelChange","ngModel"],["for","email"],["type","password","id","claveLogin","placeholder","Contrase\xF1a","name","clave",1,"form-control",3,"ngModelChange","ngModel"],["for","claveLogin"],["type","button",1,"w-100","btn","btn-lg","btn-primary",3,"click"],[3,"captchaResolved"],["class","error",4,"ngIf"],["type","submit",1,"w-100","btn","btn-lg","btn-primary"],[1,"form-check","mb-3"],["type","checkbox","value","","id","recordarme","name","recordarme",1,"form-check-input",3,"ngModelChange","ngModel"],["for","recordarme",1,"form-check-label"],[1,"text-center","mt-3"],["type","button",1,"btn","btn-lg","btn-primary",3,"click"],[1,"fab","fa-google","me-2"],["routerLink","/registro",1,"btn","btn-lg","btn-primary"],[1,"error"]],template:function(o,t){o&1&&(n(0,"main",0)(1,"form",1),h("ngSubmit",function(){return t.login()}),n(2,"h1",2),c(3,"Ingresar"),i(),n(4,"div",3)(5,"input",4),_("ngModelChange",function(l){return C(t.mail,l)||(t.mail=l),l}),i(),n(6,"label",5),c(7,"Email"),i()(),n(8,"div",3)(9,"input",6),_("ngModelChange",function(l){return C(t.clave,l)||(t.clave=l),l}),i(),n(10,"label",7),c(11,"Contrase\xF1a"),i()(),n(12,"div")(13,"button",8),h("click",function(){return t.usuarioPorDefecto()}),c(14,"Usuario por defecto"),i()(),n(15,"app-captcha",9),h("captchaResolved",function(l){return t.onCaptchaResolved(l)}),i(),v(16,Y,2,1,"div",10),n(17,"div")(18,"button",11),c(19,"Iniciar sesi\xF3n"),i()(),n(20,"div",12)(21,"input",13),_("ngModelChange",function(l){return C(t.recordarme,l)||(t.recordarme=l),l}),i(),n(22,"label",14),c(23," Recordarme "),i()(),g(24,"hr"),n(25,"div",15)(26,"button",16),h("click",function(){return t.loginWithGoogle()}),g(27,"i",17),c(28," Iniciar sesi\xF3n con Google "),i()(),g(29,"hr"),n(30,"div",15)(31,"button",18),c(32,"Registrarme"),i()()()()),o&2&&(s(5),b("ngModel",t.mail),s(4),b("ngModel",t.clave),s(7),d("ngIf",t.mensajeError),s(5),b("ngModel",t.recordarme))},dependencies:[B,W,S,j,E,x,G,V,L,y,Q],styles:['.form-signin[_ngcontent-%COMP%]{width:100%;height:100vh;padding:0;background-image:url("./media/medicalutn1-NOQABUCO.jpg");background-size:cover;background-repeat:no-repeat;background-attachment:fixed;background-position:center;display:flex;flex-direction:column;justify-content:center;align-items:center;color:#fff}.form-control[_ngcontent-%COMP%]{height:50px;font-size:18px}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff;height:50px;font-size:18px}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;border-color:#0056b3}.form-floating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#495057;font-size:18px}.form-floating[_ngcontent-%COMP%]{margin-bottom:1rem}.estado-registro[_ngcontent-%COMP%], .checkbox[_ngcontent-%COMP%]{margin-top:1rem}.form-signin[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;margin-bottom:1rem;width:100px}a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.exito[_ngcontent-%COMP%]{color:green}.advertencia[_ngcontent-%COMP%]{color:orange}.error[_ngcontent-%COMP%]{color:red;margin-top:10px}']});let r=a;return r})();export{fe as a};
