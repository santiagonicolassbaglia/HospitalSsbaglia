<div class="filtros">
  <input 
    type="text" 
    placeholder="Buscar..." 
    [(ngModel)]="filtroGeneral" 
    (input)="aplicarFiltro()" 
  />
</div>

<div class="turnos">
  <div *ngFor="let turno of turnosFiltrados" class="turno">
    <p>Especialidad: {{ turno.especialidad }}</p>
    <p>Especialista: {{ turno.especialistaNombre }}</p>
    <p>Fecha y Hora: {{ turno.fechaHora | date:'dd/MM/yyyy HH:mm' }}</p>
    <p>Estado: {{ turno.estado }}</p>

    <div *ngIf="turno.estado !== 'realizado'">
      <button (click)="turno.mostrarcomentario = !turno.mostrarcomentario">Cancelar Turno</button>
      <div *ngIf="turno.mostrarcomentario">
        <textarea [(ngModel)]="turno.comentario" placeholder="Razón de cancelación"></textarea>
        <button (click)="cancelarTurno(turno)">Confirmar Cancelación</button>
      </div>
    </div>

    <button *ngIf="turno.comentario && !turno.mostrarresenia" (click)="verResenia(turno)">Ver Reseña</button>
    <div *ngIf="turno.mostrarresenia">
      <p>Reseña: {{ turno.comentario }}</p>
      <button (click)="turno.mostrarresenia = false">Ocultar Reseña</button>
    </div>
    <button *ngIf="turno.estado === 'realizado'" (click)="completarEncuesta(turno)">Completar Encuesta</button>
    <button *ngIf="turno.estado === 'realizado'" (click)="calificarAtencion(turno, 'Comentario de la atención')">Calificar Atención</button>
  </div>
</div>
